import pandas as pd

# 프로젝트 분석 데이터
def create_project_analysis_excel():
    # 전체 프로젝트 개요
    overview_data = [
        {"항목": "프로젝트명", "값": "GANTY-LODER 자동 용접 시스템"},
        {"항목": "총 프로젝트 금액", "값": "980,181,870원"}
    ]
    
    # 메인 분석표
    main_analysis_data = [
        {"구분": "기계 어셈블리", "항목": "SADDLE", "총금액": 53070336, "제작서비스": 4977336, "구매금액": 48093000, "제작비율": "9.4%"},
        {"구분": "기계 어셈블리", "항목": "CARRIAGE", "총금액": 15159090, "제작서비스": 2164090, "구매금액": 12995000, "제작비율": "14.3%"},
        {"구분": "기계 어셈블리", "항목": "Y-AXIS", "총금액": 71698323, "제작서비스": 24698323, "구매금액": 47000000, "제작비율": "34.4%"},
        {"구분": "기계 어셈블리", "항목": "Z-AXIS", "총금액": 30442500, "제작서비스": 2442500, "구매금액": 28000000, "제작비율": "8.0%"},
        {"구분": "기계 어셈블리", "항목": "X-AXIS", "총금액": 17198621, "제작서비스": 9198621, "구매금액": 8000000, "제작비율": "53.5%"},
        {"구분": "기계 어셈블리", "항목": "R-AXIS", "총금액": 452583000, "제작서비스": 7583000, "구매금액": 445000000, "제작비율": "1.7%"},
        {"구분": "기계 어셈블리", "항목": "잡자재", "총금액": 30000, "제작서비스": 0, "구매금액": 30000, "제작비율": "0%"},
        {"구분": "기계 어셈블리", "항목": "소계", "총금액": 640181870, "제작서비스": 50063870, "구매금액": 590118000, "제작비율": "7.8%"},
        {"구분": "전장 시스템", "항목": "제어전장 구매품", "총금액": 90000000, "제작서비스": 0, "구매금액": 90000000, "제작비율": "0%"},
        {"구분": "설치/시운전", "항목": "기계설치시운전", "총금액": 120000000, "제작서비스": 120000000, "구매금액": 0, "제작비율": "100%"},
        {"구분": "설치/시운전", "항목": "제어설치시운전", "총금액": 50000000, "제작서비스": 50000000, "구매금액": 0, "제작비율": "100%"},
        {"구분": "후처리", "항목": "후처리 작업", "총금액": 80000000, "제작서비스": 80000000, "구매금액": 0, "제작비율": "100%"},
        {"구분": "총계", "항목": "총계", "총금액": 980181870, "제작서비스": 300063870, "구매금액": 680118000, "제작비율": "30.6%"}
    ]
    
    # 고가 구매품목
    expensive_items_data = [
        {"품목": "ABB 로봇 시스템", "금액": 110000000, "비고": "R-AXIS 핵심 장비"},
        {"품목": "LINCOLN 용접기 R450", "금액": 34800000, "비고": "용접 핵심 장비"},
        {"품목": "Y-AXIS GIRDER", "금액": 19500000, "비고": "제작 품목"},
        {"품목": "감속기 (YJD110)", "금액": 2758000, "비고": "SADDLE용, 6개"},
        {"품목": "APEX 감속기 (AFR140)", "금액": 1795000, "비고": "CARRIAGE용, 3개"},
        {"품목": "THK LM GUIDE", "금액": 1340720, "비고": "Y-AXIS용, 6개"},
        {"품목": "한국이구스 에너지체인", "금액": 3400000, "비고": "Z-AXIS용"},
        {"품목": "THK 볼스크류", "금액": 2370000, "비고": "Z-AXIS용"}
    ]
    
    # 주요 제작품목
    manufacturing_items_data = [
        {"품목": "X-RAIL", "금액": 3675000, "어셈블리": "X-AXIS"},
        {"품목": "X-BEAM", "금액": 4241500, "어셈블리": "X-AXIS"},
        {"품목": "POST-BODY", "금액": 851250, "수량": 18, "어셈블리": "X-AXIS"},
        {"품목": "Y-AXIS GIRDER", "금액": 19500000, "어셈블리": "Y-AXIS"},
        {"품목": "CARRIAGE-PLATE", "금액": 1497000, "어셈블리": "CARRIAGE"},
        {"품목": "Z-BEAM", "금액": 1857750, "어셈블리": "Z-AXIS"}
    ]
    
    # 분야별 비율
    category_ratio_data = [
        {"분야": "기계 어셈블리", "금액": 640181870, "비율": "65.3%"},
        {"분야": "제어전장", "금액": 90000000, "비율": "9.2%"},
        {"분야": "설치/시운전", "금액": 170000000, "비율": "17.3%"},
        {"분야": "후처리", "금액": 80000000, "비율": "8.2%"}
    ]
    
    # DataFrame 생성
    df_overview = pd.DataFrame(overview_data)
    df_main = pd.DataFrame(main_analysis_data)
    df_expensive = pd.DataFrame(expensive_items_data)
    df_manufacturing = pd.DataFrame(manufacturing_items_data)
    df_category = pd.DataFrame(category_ratio_data)
    
    # 엑셀 파일로 저장
    with pd.ExcelWriter('project_analysis.xlsx', engine='openpyxl') as writer:
        df_overview.to_excel(writer, sheet_name='프로젝트 개요', index=False)
        df_main.to_excel(writer, sheet_name='메인 분석표', index=False)
        df_expensive.to_excel(writer, sheet_name='고가 구매품목', index=False)
        df_manufacturing.to_excel(writer, sheet_name='주요 제작품목', index=False)
        df_category.to_excel(writer, sheet_name='분야별 비율', index=False)
    
    return df_main, df_expensive, df_manufacturing, df_category

if __name__ == "__main__":
    create_project_analysis_excel()
    print("엑셀 파일이 생성되었습니다: project_analysis.xlsx")
